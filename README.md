# Lisp Batch Processor

Lisp Batch Processor is a simple yet powerful tool crafted for batch processing of DWG files using AutoCAD alongside user-defined Lisp scripts. This is my first Python project—indeed, I had zero Python knowledge before starting this project and still know almost zero after its completion! :p

## Introduction

This project was coded in 24 hours with 95% of the code generated by the assistance of GitHub Copilot Pro AI GPT-4o and o3-min. I spent almost half a day learning how to compile Python applications, and the experience has been incredibly educational. I used Thonny as the IDE, which is very easy for beginners, fast, and comes with an easy module installation process—highly recommended!

## Features

- **Automatic DWG Processing:** Process multiple DWG files in a batch.
- **Lisp Script Execution:** Run multiple Lisp scripts on each file, with the ability to reorder the execution order using intuitive up/down arrow buttons.
- **Automatic Lisp Detection:** The software automatically detects Lisp scripts located in the `lisp` folder within the application directory.
- **Drag and Drop Support:** Add DWG files effortlessly via drag and drop.
- **Real-Time Status Updates:** Get updates like "`myscript.lsp completed for file X (Lisp 1 of 3)`" for each Lisp execution.
- **Configurable AutoCAD Path:** Easily set and update the AutoCAD executable location in the Options dialog.

## Usage

1. **Run the Application**

   ```bash
   python main.py
   ```

2. **Add DWG Files and Lisp Scripts**

   - Drag and drop DWG files or click the **+** button to add them.
   - Add Lisp scripts using the **Add Lisp** button. The software automatically detects any additional Lisp scripts placed in the `lisp` folder in the same directory as the executable.
   - **Important:** Each Lisp file must include the function call `(c:MyLispFunction)` in its code. This function acts as the entry point when the script is invoked by the application.

3. **Configure AutoCAD**

   Use the Options dialog to set or update the path to your AutoCAD executable.

4. **Process Files**

   Once everything is set, click the **Process Files** button to start processing your DWG files with the specified and ordered Lisp scripts.

## Creating Your Lisp Script

Ensure that each Lisp script you write includes an invokable function defined as follows:

```lisp
(defun c:MyLispFunction ( / )
  ;; Your code here
  (princ "\nMy Lisp function executed successfully.")
)
(c:MyLispFunction) ; IMPORTANT TO AUTOMATICALLY INVOKE
```

The application invokes this function after loading the Lisp script. Adjust the code within `(c:MyLispFunction)` as needed for your automation tasks.

## Installation

1. **Clone the Repository**

   ```bash
   git clone https://github.com/jiraiya78/lisp-batch-processor.git
   cd lisp-batch-processor
   ```

2. **Install Dependencies**

   This project requires Python 3 along with the following packages:

   - `tkinter`
   - `pywin32`
   - `Pillow`
   - `tkinterdnd2`

   Install the required packages by running:

   ```bash
   pip install -r requirements.txt
   ```

3. **Compile the Application (Optional)**

   If you want to compile the application into a standalone executable, you can use PyInstaller. For example:

   ```bash
   pyinstaller --onefile --noconsole --add-data="tkinterdnd2;tkinterdnd2" main.py
   ```

   *Note:* Ensure that the `lisp` folder is placed in the same directory as the compiled executable for the software to detect and list your Lisp scripts automatically.

## Contributing

Contributions are welcome! Please open an issue or submit a pull request if you have any suggestions or improvements.

## Affiliation and Credits

- **Author:** jiraiya78
- **Affiliation:** SSP(E&M) Sdn Bhd (Malaysia)  
  **Contact – Name:** Azri

## License

This project is licensed under the GNU GPLv3.0. See the [LICENSE](LICENSE) file for details.
```
